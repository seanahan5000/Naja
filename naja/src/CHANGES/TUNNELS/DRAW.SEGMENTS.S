				LST	OFF
				TR	ON

DATA_PTR		=	$00				;$01
OFFSET			=	$02				;$03
TOP_LINE		=	$04
BOTTOM_LINE		=	$05
LEFT_COLUMN		=	$06
RIGHT_COLUMN	=	$07
WIDTH			=	RIGHT_COLUMN
TEMP			=	$08				;$09
SOURCE_INDEX	=	$0A
DEST_INDEX		=	$0B
SCREENL			=	$26
SCREENH			=	$27
PAGE			=	$E6

				ORG	$FA00

DRIVER			ASL
				TAX
				LDA	SEG_TABLE+1,X
				TAY
				LDA	SEG_TABLE,X
				TAX

DRAW_SEGMENTS	STX	DATA_PTR
				STY	DATA_PTR+1
				STA	$C003			;read aux 48K
DRAW_LOOP		LDY	#0
				LDA	(DATA_PTR),Y	;get segment type
				BMI	:5
				INY
				TAX
				LDA	(DATA_PTR),Y
				STA	TOP_LINE
				INY
				LDA	(DATA_PTR),Y
				STA	BOTTOM_LINE
				INY
				DEX
				BMI	:1
				BEQ	:2
				DEX
				BEQ	:3
				DEX
				BEQ	:4
				JMP	UNPK_CENTER
:1				JMP	DRAW_LEFT
:2				JMP	DRAW_CENTER
:3				JMP	DRAW_RIGHT
:4				JMP	DRAW_PATCH
:5				STA	$C002			;read main 48K
				RTS

				PUT	DRAW.LEFT
				PUT	DRAW.CENTER
				PUT	DRAW.RIGHT
				PUT	DRAW.PATCH
				PUT	UNPK.CENTER
				PUT	/CHANGES/HIRES.TABLES

SEG_TABLE		DW	A0L				;0
				DW	A1L
				DW	A2L
				DW	A3L
				DW	A4L
				DW	A0R
				DW	A1R
				DW	A2R
				DW	A3R
				DW	A4R
				DW	C0
				DW	C1
				DW	C2
				DW	C3
				DW	C4
				DW	B0L
				DW	B1L
				DW	B2L
				DW	B3L
				DW	B4L
				DW	B0R
				DW	B1R
				DW	B2R
				DW	B3R
				DW	B4R
				DW	P0L
				DW	P1L
				DW	P2L
				DW	P3L
				DW	P4L
				DW	P0R
				DW	P1R
				DW	P2R
				DW	P3R
				DW	P4R

				DW	DA0L			;35
				DW	DA1L
				DW	DA2L
				DW	DA3L
				DW	DA4L
				DW	DA0R
				DW	DA1R
				DW	DA2R
				DW	DA3R
				DW	DA4R
				DW	DC0
				DW	DC1
				DW	DC2
				DW	DC3
				DW	DC4
				DW	DB0L
				DW	DB1L
				DW	DB2L
				DW	DB3L
				DW	DB4L
				DW	DB0R
				DW	DB1R
				DW	DB2R
				DW	DB3R
				DW	DB4R

				DW	TOP0L			;60
				DW	WWW0L
				DW	WDW0L
				DW	DWD0L
				DW	DDD0L
				DW	TOP1L
				DW	WWW1L
				DW	WDW1L
				DW	DWD1L
				DW	DDD1L
				DW	TOP2L
				DW	WWW2L
				DW	WDW2L
				DW	DWD2L
				DW	DDD2L
				DW	TOP3L
				DW	WWW3L
				DW	WDW3L
				DW	DWD3L
				DW	DDD3L
				DW	TOP4L
				DW	WWW4L
				DW	WDW4L
				DW	DWD4L
				DW	DDD4L

				DW	TOP0R			;85
				DW	WWW0R
				DW	WDW0R
				DW	DWD0R
				DW	DDD0R
				DW	TOP1R
				DW	WWW1R
				DW	WDW1R
				DW	DWD1R
				DW	DDD1R
				DW	TOP2R
				DW	WWW2R
				DW	WDW2R
				DW	DWD2R
				DW	DDD2R
				DW	TOP3R
				DW	WWW3R
				DW	WDW3R
				DW	DWD3R
				DW	DDD3R
				DW	TOP4R
				DW	WWW4R
				DW	WDW4R
				DW	DWD4R
				DW	DDD4R

				DW	DOPENL			;110
				DW	DOPENR

				SAV	DRAW.SEGMENTS


				DSK	SEGMENT.DATA1
				ORG	$0400

A0L
				PUT	WALLS/A0L
A1L
				PUT	WALLS/A1L
A2L
				PUT	WALLS/A2L
A3L
				PUT	WALLS/A3L
A4L
				PUT	WALLS/A4L
A4R
				PUT	WALLS/A4R
A3R
				PUT	WALLS/A3R
A2R
				PUT	WALLS/A2R
A1R
				PUT	WALLS/A1R
A0R
				PUT	WALLS/A0R
C0
				PUT	WALLS/C0
C1
				PUT	WALLS/C1
C2
				PUT	WALLS/C2
C3
				PUT	WALLS/C3
C4
				PUT	WALLS/C4
B0L
				PUT	WALLS/B0L
B0R
				PUT	WALLS/B0R
B1L
				PUT	WALLS/B1L
B1R
				PUT	WALLS/B1R
B2L
				PUT	WALLS/B2L
B2R
				PUT	WALLS/B2R
B3L
				PUT	WALLS/B3L
B3R
				PUT	WALLS/B3R
B4L
				PUT	WALLS/B4L
B4R
				PUT	WALLS/B4R
P0L
				PUT	PILLARS/P0L
P0R
				PUT	PILLARS/P0R
P1L
				PUT	PILLARS/P1L
P1R
				PUT	PILLARS/P1R
P2L
				PUT	PILLARS/P2L
P2R
				PUT	PILLARS/P2R
P3L
				PUT	PILLARS/P3L
P3R
				PUT	PILLARS/P3R
P4L
				PUT	PILLARS/P4L
P4R
				PUT	PILLARS/P4R
DA0L
				PUT	DOORS/D.A0L
DA1L
				PUT	DOORS/D.A1L
DA2L
				PUT	DOORS/D.A2L
DA3L
				PUT	DOORS/D.A3L
DA4L
				PUT	DOORS/D.A4L
DA4R
				PUT	DOORS/D.A4R
DA3R
				PUT	DOORS/D.A3R
DA2R
				PUT	DOORS/D.A2R
DA1R
				PUT	DOORS/D.A1R
DA0R
				PUT	DOORS/D.A0R
DC0
				PUT	DOORS/D.C0
DC1
				PUT	DOORS/D.C1
DC2
				PUT	DOORS/D.C2
DC3
				PUT	DOORS/D.C3
DC4
				PUT	DOORS/D.C4

DB0L
				PUT	DOORS/D.B0L
DB0R
				PUT	DOORS/D.B0R
DB1L
				PUT	DOORS/D.B1L
DB1R
				PUT	DOORS/D.B1R
DB2L
				PUT	DOORS/D.B2L
DB2R
				PUT	DOORS/D.B2R
DB3L
				PUT	DOORS/D.B3L

				DSK	SEGMENT.DATA2
				ORG	$D000

DB3R
				PUT	DOORS/D.B3R
DB4L
				PUT	DOORS/D.B4L
DB4R
				PUT	DOORS/D.B4R

TOP0L
				PUT	PATCHES/TOP0L
WWW0L
				PUT	PATCHES/WWW0L
WDW0L
				PUT	PATCHES/WDW0L
DWD0L
				PUT	PATCHES/DWD0L
DDD0L
				PUT	PATCHES/DDD0L
TOP1L
				PUT	PATCHES/TOP1L
WWW1L
				PUT	PATCHES/WWW1L
WDW1L
				PUT	PATCHES/WDW1L
DWD1L
				PUT	PATCHES/DWD1L
DDD1L
				PUT	PATCHES/DDD1L
TOP2L
				PUT	PATCHES/TOP2L
WWW2L
				PUT	PATCHES/WWW2L
WDW2L
				PUT	PATCHES/WDW2L
DWD2L
				PUT	PATCHES/DWD2L
DDD2L
				PUT	PATCHES/DDD2L
TOP3L
				PUT	PATCHES/TOP3L
WWW3L
				PUT	PATCHES/WWW3L
WDW3L
				PUT	PATCHES/WDW3L
DWD3L
				PUT	PATCHES/DWD3L
DDD3L
				PUT	PATCHES/DDD3L
TOP4L
				PUT	PATCHES/TOP4L
WWW4L
				PUT	PATCHES/WWW4L
WDW4L
				PUT	PATCHES/WDW4L
DWD4L
				PUT	PATCHES/DWD4L
DDD4L
				PUT	PATCHES/DDD4L

TOP0R
				PUT	PATCHES/TOP0R
WWW0R
				PUT	PATCHES/WWW0R
WDW0R
				PUT	PATCHES/WDW0R
DWD0R
				PUT	PATCHES/DWD0R
DDD0R
				PUT	PATCHES/DDD0R
TOP1R
				PUT	PATCHES/TOP1R
WWW1R
				PUT	PATCHES/WWW1R
WDW1R
				PUT	PATCHES/WDW1R
DWD1R
				PUT	PATCHES/DWD1R
DDD1R
				PUT	PATCHES/DDD1R
TOP2R
				PUT	PATCHES/TOP2R
WWW2R
				PUT	PATCHES/WWW2R
WDW2R
				PUT	PATCHES/WDW2R
DWD2R
				PUT	PATCHES/DWD2R
DDD2R
				PUT	PATCHES/DDD2R
TOP3R
				PUT	PATCHES/TOP3R
WWW3R
				PUT	PATCHES/WWW3R
WDW3R
				PUT	PATCHES/WDW3R
DWD3R
				PUT	PATCHES/DWD3R
DDD3R
				PUT	PATCHES/DDD3R
TOP4R
				PUT	PATCHES/TOP4R
WWW4R
				PUT	PATCHES/WWW4R
WDW4R
				PUT	PATCHES/WDW4R
DWD4R
				PUT	PATCHES/DWD4R
DDD4R
				PUT	PATCHES/DDD4R

DOPENL
				PUT	DOORS/D.OPEN.L
DOPENR
				PUT	DOORS/D.OPEN.R
