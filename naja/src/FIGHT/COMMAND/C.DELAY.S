DELAY			JSR	CLRBOX
				LDY	#$01
				JSR	TEXTER
				LDA	DELAY_TIME
				JSR	DIGIT_DRAW
				JSR	LINE2
				LDY	#$02
				JSR	TEXTER
				LDA	#$99
				JSR	INPUT_SUB
				BCC	:SKIPA
				STA	DELAY_TIME
:SKIPA			JSR	CLRBOX
				JSR	OPTIONS
				JMP	GETOP2

DIGIT_DRAW		PHA
				LSR
				LSR
				LSR
				LSR
				BNE	:SKIPA
				LDA	#$0A
:SKIPA			STA	TEXTBUF
				PLA	
				AND	#$0F
				STA	TEXTBUF+1
				LDA	#$8D
				STA	TEXTBUF+2
				RTS

INPUT_SUB		STA	SCRATCH
				LDA	#$02	
				STA	MAXTEXT
				JSR	INPUT2
DELAYIN			STX	HOLDIT
				LDA	TEXTBUF
				CMP	#$8D
				BEQ	NONEW1
				LDA	TEXTBUF
				STA	SCREENL
				LDA	TEXTBUF+1
				STA	SCREENH
				CMP	#$A0
				BEQ	NJSKIP3
				CMP	#$8D
				BNE	NOJUST1
NJSKIP3			LDA	SCREENL	
				STA	SCREENH
				LDA	#$A0
				STA	SCREENL
NOJUST1			LDA	SCREENL
				CMP	#$A0
				BNE	NOJUST2
				CMP	SCREENH
				BEQ	NONEW1
NOJUST2			JSR	CONVERT
				CPX	#$FF
				BEQ	DEFAIL
				CPX	#$0A
				BEQ	NJSKIP2
				BCS	DEFAIL
				BCC	NJSKIP1			;Always
NJSKIP2			LDX	#$00
NJSKIP1			STX	SCREENL
				LDA	SCREENH
				JSR	CONVERT
				CPX	#$FF
				BEQ	DEFAIL
				CPX	#$0A
				BCS	DEFAIL
				STX	SCREENH
				LDA	SCREENL
				ASL
				ASL
				ASL
				ASL
				ORA	SCREENH
				CMP	SCRATCH
				BEQ	OKNEW
				BCS	DEFAIL
OKNEW			SEC
				RTS
NONEW1			CLC
				RTS	
DEFAIL			JSR	CHAROUT
				JSR	RECALL
				JMP	DELAYIN
